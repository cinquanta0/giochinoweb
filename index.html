<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gioco dei Numeri</title>
  <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(to right, #2c3e50, #3498db);
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 30px;
      height: 100vh;
      justify-content: center;
      text-align: center;
      margin: 0;
      animation: background-animation 20s infinite alternate;
      overflow: hidden;
    }

    @keyframes background-animation {
      0% { background: linear-gradient(to right, #2c3e50, #3498db); }
      50% { background: linear-gradient(to right, #f39c12, #e74c3c); }
      100% { background: linear-gradient(to right, #8e44ad, #2980b9); }
    }

    h1 {
      font-family: 'Bangers', cursive;
      font-size: 5rem;
      margin: 0 0 40px;
      text-shadow: 4px 4px 15px rgba(0,0,0,0.5);
      color: #FF6347;
      text-transform: uppercase;
    }

    .container {
      background: rgba(255, 255, 255, 0.1);
      padding: 40px;
      border-radius: 20px;
      backdrop-filter: blur(10px);
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
      text-align: center;
      width: 320px;
      animation: fadeIn 1s ease forwards;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    button {
      padding: 15px;
      margin: 10px 0;
      font-size: 1.2rem;
      border-radius: 12px;
      border: none;
      outline: none;
      background: #00fff2;
      color: black;
      cursor: pointer;
      font-weight: bold;
    }

    button:hover {
      background: #00cfc4;
    }

    #message {
      margin-top: 20px;
      font-size: 1.5rem;
      font-weight: bold;
      color: #f39c12;
    }

    #tentativi {
      color: yellow;
      font-weight: bold;
    }

    .hidden {
      display: none;
    }

    .music-btn, .home-btn {
      position: fixed;
      top: 20px;
      padding: 10px 20px;
      font-size: 1.2rem;
      border-radius: 20px;
      font-weight: bold;
      cursor: pointer;
      border: none;
    }

    .music-btn {
      right: 20px;
      background: #e74c3c;
      color: white;
    }

    .home-btn {
      left: 20px;
      background: #f39c12;
      color: black;
    }

    .home-btn:hover, .music-btn:hover {
      opacity: 0.9;
    }

    .level-btn {
      margin: 10px;
      padding: 15px;
      font-size: 1.5rem;
      border-radius: 12px;
      width: 200px;
      cursor: pointer;
      background-color: #3498db;
      color: white;
      border: none;
    }

    .level-btn:disabled {
      background-color: #7f8c8d;
      cursor: not-allowed;
    }

    .logo {
      width: 200px;
      margin-bottom: 30px;
    }

    #scoreForm input {
      margin-top: 10px;
      padding: 10px;
      font-size: 1rem;
      border-radius: 10px;
      border: none;
      width: 80%;
    }

    #leaderboard ul {
      list-style: none;
      padding: 0;
    }

    #leaderboard li {
      font-size: 1.1rem;
      margin: 5px 0;
    }

    #scoreForm, #leaderboard {
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <img src="logo-gioco.png" alt="Logo del Gioco" class="logo">

  <button onclick="goHome()" class="home-btn">üè† Home</button>
  <button onclick="toggleMusic()" class="music-btn">üéµ Musica</button>

  <audio id="bgMusic" src="musica.mp3" loop></audio>
  <audio id="winSound" src="win.mp3"></audio>
  <audio id="loseSound" src="lose.mp3"></audio>

  <!-- Schermata Selezione Modalit√† -->
  <div id="intro">
    <h1>üéâ Benvenuto!</h1>
    <div class="container">
      <h2>üéØ Gioco dei Numeri üéØ</h2>
      <p>Seleziona la modalit√† di gioco:</p>
      <button onclick="startMode('easy')">Facile</button>
      <button onclick="startMode('medium')">Medio</button>
      <button onclick="startMode('hard')">Difficile</button>
      <button onclick="showLeaderboard()">üèÜ Classifica</button>
    </div>
  </div>

  <!-- Schermata Selezione Livelli -->
  <div id="levelSelect" class="hidden">
    <h2>Seleziona un Livello</h2>
    <div id="levelButtons"></div>
  </div>

  <!-- Gioco -->
  <div id="game" class="hidden">
    <div class="container">
      <h2>üî¢ Livello <span id="livelloCorrente">1</span> (da 0 a <span id="maxNumber">10</span>)</h2>
      <p>Inserisci un numero:</p>
      <input type="number" id="userGuess" min="0" />
      <button onclick="check()">Verifica</button>
      <p>Tentativi rimasti: <span id="tentativi">10</span></p>
      <p id="message"></p>
      <button id="retryBtn" class="hidden" onclick="retry()">üîÅ Riprova</button>
      <p id="timer" class="hidden">Tempo rimanente: <span id="timerValue">45</span> sec</p>

      <div id="scoreForm" class="hidden">
        <p>üéâ Inserisci il tuo nome per la classifica:</p>
        <input type="text" id="playerName" placeholder="Il tuo nome" />
        <button onclick="saveScore()">Salva</button>
      </div>
    </div>
  </div>

  <!-- Classifica -->
  <div id="leaderboard" class="hidden">
    <div class="container">
      <h2>üèÜ Classifica</h2>
      <ul id="scoreList"></ul>
      <button onclick="goHome()">üîô Torna alla Home</button>
    </div>
  </div>

  <script>
    let currentLevel = 1;
    let numeroSegreto = 0;
    let tentativiRimasti = 10;
    let score = 0;
    let timerInterval;
    let timerValue = 45;
    let gameMode = 'easy';
    let levelsUnlocked = { easy: [1], medium: [1], hard: [1] };

    function startMode(mode) {
      gameMode = mode;
      score = 0;
      document.getElementById("intro").classList.add("hidden");
      document.getElementById("levelSelect").classList.remove("hidden");
      loadLevelButtons();
    }

    function loadLevelButtons() {
      let buttonsHtml = '';
      for (let i = 1; i <= 10; i++) {
        buttonsHtml += `<button class="level-btn" ${levelsUnlocked[gameMode].includes(i) ? '' : 'disabled'} onclick="startLevel(${i})">Livello ${i}</button>`;
      }
      document.getElementById('levelButtons').innerHTML = buttonsHtml;
    }

    function startLevel(level) {
      currentLevel = level;
      avviaLivello();
      document.getElementById("levelSelect").classList.add("hidden");
      document.getElementById("game").classList.remove("hidden");
    }

    function avviaLivello() {
      const maxNumber = livelloMax(currentLevel);
      numeroSegreto = Math.floor(Math.random() * (maxNumber + 1));
      tentativiRimasti = currentLevel <= 5 ? 5 : 10;
      if (gameMode === 'medium') tentativiRimasti -= 2;

      document.getElementById("tentativi").textContent = tentativiRimasti;
      document.getElementById("livelloCorrente").textContent = currentLevel;
      document.getElementById("maxNumber").textContent = maxNumber;
      document.getElementById("message").textContent = '';
      document.getElementById("retryBtn").classList.add("hidden");
      document.getElementById("userGuess").value = '';
      document.getElementById("scoreForm").classList.add("hidden");
      document.getElementById("timer").classList.toggle("hidden", gameMode !== 'hard');
      document.getElementById("timerValue").textContent = timerValue;

      if (gameMode === 'hard') startTimer();
    }

    function livelloMax(livello) {
      const valori = [10, 20, 30, 50, 70, 100, 150, 200, 500, 1000];
      return valori[livello - 1] || 1000;
    }

    function startTimer() {
      timerValue = 45;
      clearInterval(timerInterval);
      timerInterval = setInterval(() => {
        timerValue--;
        document.getElementById("timerValue").textContent = timerValue;
        if (timerValue <= 0) {
          clearInterval(timerInterval);
          document.getElementById("message").textContent = "‚ùå Tempo scaduto! Il numero era " + numeroSegreto;
          document.getElementById("retryBtn").classList.remove("hidden");
          document.getElementById("loseSound").play();
        }
      }, 1000);
    }

    function check() {
      const guess = parseInt(document.getElementById("userGuess").value);
      if (isNaN(guess)) return;

      if (guess === numeroSegreto) {
        score += 10;
        document.getElementById("message").textContent = "üéâ Corretto!";
        document.getElementById("winSound").play();
        clearInterval(timerInterval);
        setTimeout(() => {
          if (currentLevel < 10) {
            levelsUnlocked[gameMode].push(currentLevel + 1);
            loadLevelButtons();
            avviaLivello();
          } else {
            document.getElementById("message").textContent = `üèÜ Hai completato il gioco! Punteggio: ${score}`;
            document.getElementById("scoreForm").classList.remove("hidden");
          }
        }, 1500);
      } else {
        tentativiRimasti--;
        document.getElementById("tentativi").textContent = tentativiRimasti;
        if (tentativiRimasti === 0) {
          clearInterval(timerInterval);
          document.getElementById("loseSound").play();
          document.getElementById("message").textContent = "‚ùå Hai perso! Il numero era " + numeroSegreto;
          document.getElementById("retryBtn").classList.remove("hidden");
        } else {
          document.getElementById("message").textContent = guess < numeroSegreto ? "üìâ Troppo basso!" : "üìà Troppo alto!";
        }
      }
    }

    function retry() {
      avviaLivello();
    }

    function goHome() {
      document.getElementById("game").classList.add("hidden");
      document.getElementById("levelSelect").classList.add("hidden");
      document.getElementById("leaderboard").classList.add("hidden");
      document.getElementById("intro").classList.remove("hidden");
      clearInterval(timerInterval);
    }

    function toggleMusic() {
      const music = document.getElementById("bgMusic");
      music.paused ? music.play() : music.pause();
    }

    function saveScore() {
      const name = document.getElementById("playerName").value.trim();
      if (!name) return alert("Inserisci un nome!");

      const newScore = { name, score };
      const leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];
      leaderboard.push(newScore);
      leaderboard.sort((a, b) => b.score - a.score);
      localStorage.setItem("leaderboard", JSON.stringify(leaderboard));

      document.getElementById("scoreForm").classList.add("hidden");
      showLeaderboard();
    }

    function showLeaderboard() {
      document.getElementById("intro").classList.add("hidden");
      document.getElementById("levelSelect").classList.add("hidden");
      document.getElementById("game").classList.add("hidden");
      document.getElementById("leaderboard").classList.remove("hidden");

      const leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];
      const list = leaderboard.map(entry => `<li>${entry.name} - ${entry.score} punti</li>`).join('');
      document.getElementById("scoreList").innerHTML = list || "<li>Nessun punteggio ancora!</li>";
    }
  </script>
</body>
</html>
